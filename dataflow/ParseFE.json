{
	"name": "ParseFE",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Json3",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SqlServerTable1",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "flatten1"
				},
				{
					"name": "flatten2"
				},
				{
					"name": "MapDrifted1",
					"description": "Creates an explicit mapping for each drifted column"
				}
			],
			"scriptLines": [
				"source(output(",
				"          status as string,",
				"          createdDateTime as string,",
				"          lastUpdatedDateTime as string,",
				"          analyzeResult as (apiVersion as string, modelId as string, stringIndexType as string, content as string, pages as (pageNumber as integer, angle as integer, width as double, height as integer, unit as string, words as (content as string, boundingBox as double[], confidence as integer, span as (offset as integer, length as integer))[], selectionMarks as string[], lines as (content as string, boundingBox as double[], spans as (offset as integer, length as integer)[])[], spans as (offset as integer, length as integer)[])[], tables as (rowCount as integer, columnCount as integer, cells as (kind as string, rowIndex as integer, columnIndex as integer, rowSpan as integer, columnSpan as integer, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[])[], boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[])[], styles as string[], documents as (docType as string, boundingRegions as (pageNumber as integer, boundingBox as integer[])[], fields as ({req-nome} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {tr-tlf} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {loc_imo-gps1} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {tr-ndgeg} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {req-morada} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {loc_imo-entrada1} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {tr-email} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {loc_imo-gps2} as (type as string, confidence as double), {loc_imo-freguesia} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {loc_imo-distrito} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {tr-nome} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {req-email} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {req-nif_nipc} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {req-tlf} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {req-cpostal} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {loc_imo-entrada2} as (type as string, confidence as double), {req-assinatura} as (type as string, confidence as double), {tr-nif} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), {loc_imo-concelho} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], confidence as double, spans as (offset as integer, length as integer)[]), tbl_inst_eletrica as (type as string, valueArray as (type as string, valueObject as ({ie-tipo_insta} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-entrada_imo} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-ramal} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-nip} as (type as string), {ie-cpe} as (type as string), {ie-andar} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-fracao} as (type as string), {ie-tipo_util} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-entrada} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-total_instal} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-fator_simult} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[]), {ie-potencia} as (type as string, valueString as string, content as string, boundingRegions as (pageNumber as integer, boundingBox as double[])[], spans as (offset as integer, length as integer)[])))[])), confidence as double, spans as (offset as integer, length as integer)[])[])",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: true,",
				"     documentForm: 'arrayOfDocuments') ~> source1",
				"source1 foldDown(unroll(analyzeResult.documents),",
				"     mapColumn(",
				"          rq_nome = analyzeResult.documents.fields.{req-nome}.content,",
				"          rq_nif = analyzeResult.documents.fields.{req-nif_nipc}.content,",
				"          rq_tlf = analyzeResult.documents.fields.{req-tlf}.content,",
				"          rq_email = analyzeResult.documents.fields.{req-email}.content,",
				"          rq_morada = analyzeResult.documents.fields.{req-morada}.content,",
				"          rq_cpostal = analyzeResult.documents.fields.{req-cpostal}.content,",
				"          rq_assinatura = {analyzeResult.documents.fields.{req-assinatura}.content},",
				"          tr_nome = analyzeResult.documents.fields.{tr-nome}.content,",
				"          tr_nif = analyzeResult.documents.fields.{tr-nif}.content,",
				"          tr_tlf = analyzeResult.documents.fields.{tr-tlf}.content,",
				"          tr_email = analyzeResult.documents.fields.{tr-email}.content,",
				"          {tr-ndgeg} = analyzeResult.documents.fields.{tr-ndgeg}.content,",
				"          rq_nome_conf = analyzeResult.documents.fields.{req-nome}.confidence,",
				"          rq_nif_conf = analyzeResult.documents.fields.{req-nif_nipc}.confidence,",
				"          rq_tlf_conf = analyzeResult.documents.fields.{req-tlf}.confidence,",
				"          rq_email_conf = analyzeResult.documents.fields.{req-email}.confidence,",
				"          rq_morada_conf = analyzeResult.documents.fields.{req-morada}.confidence,",
				"          rq_cpostal_conf = analyzeResult.documents.fields.{req-cpostal}.confidence,",
				"          rq_assinatura_conf = analyzeResult.documents.fields.{req-assinatura}.confidence,",
				"          tr_nome_conf = analyzeResult.documents.fields.{tr-nome}.confidence,",
				"          tr_nif_conf = analyzeResult.documents.fields.{tr-nif}.confidence,",
				"          tr_tlf_conf = analyzeResult.documents.fields.{tr-tlf}.confidence,",
				"          tr_email_conf = analyzeResult.documents.fields.{tr-email}.confidence,",
				"          tr_ndgeg_conf = analyzeResult.documents.fields.{tr-ndgeg}.confidence,",
				"          Freguesia = analyzeResult.documents.fields.{loc_imo-freguesia}.content,",
				"          Freguesia_conf = analyzeResult.documents.fields.{loc_imo-freguesia}.confidence,",
				"          Concelho = analyzeResult.documents.fields.{loc_imo-concelho}.content,",
				"          Concelho_conf = analyzeResult.documents.fields.{loc_imo-concelho}.confidence,",
				"          Distrito = analyzeResult.documents.fields.{loc_imo-distrito}.content,",
				"          Distrito_conf = analyzeResult.documents.fields.{loc_imo-distrito}.confidence,",
				"          Entrada_E1 = analyzeResult.documents.fields.{loc_imo-entrada1}.content,",
				"          Entrada_E1_conf = analyzeResult.documents.fields.{loc_imo-entrada1}.confidence,",
				"          Entrada_E2 = analyzeResult.documents.fields.{loc_imo-entrada1}.content,",
				"          Entrada_E2_conf = analyzeResult.documents.fields.{loc_imo-entrada2}.confidence,",
				"          Coordenadas = analyzeResult.documents.fields.{loc_imo-gps1}.content,",
				"          Coordenadas_conf = analyzeResult.documents.fields.{loc_imo-gps1}.confidence,",
				"          tbl_inst_eletrica_vl = analyzeResult.documents.fields.tbl_inst_eletrica.valueArray.valueObject",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flatten1",
				"flatten1 foldDown(unroll(tbl_inst_eletrica_vl),",
				"     mapColumn(",
				"          rq_nome,",
				"          rq_nif,",
				"          rq_tlf,",
				"          rq_email,",
				"          rq_morada,",
				"          rq_cpostal,",
				"          rq_assinatura,",
				"          tr_nome,",
				"          tr_nif,",
				"          tr_tlf,",
				"          tr_email,",
				"          {tr-ndgeg},",
				"          rq_nome_conf,",
				"          rq_nif_conf,",
				"          rq_tlf_conf,",
				"          rq_email_conf,",
				"          rq_morada_conf,",
				"          rq_cpostal_conf_inc = rq_cpostal_conf,",
				"          rq_assinatura_conf,",
				"          tr_nome_conf,",
				"          tr_nif_conf,",
				"          tr_tlf_conf,",
				"          tr_email_conf,",
				"          tr_ndgeg_conf,",
				"          Freguesia,",
				"          Freguesia_conf,",
				"          Concelho,",
				"          Concelho_conf,",
				"          Distrito,",
				"          Distrito_conf,",
				"          Entrada_E1,",
				"          Entrada_E1_conf,",
				"          Entrada_E2,",
				"          Entrada_E2_conf,",
				"          Coordenadas,",
				"          Coordenadas_conf,",
				"          {Tipo_de_Instalação} = tbl_inst_eletrica_vl.{ie-tipo_insta}.content,",
				"          Entrada_do_imovel = tbl_inst_eletrica_vl.{ie-entrada_imo}.content,",
				"          Andar = tbl_inst_eletrica_vl.{ie-andar}.content,",
				"          {Fracçao} = tbl_inst_eletrica_vl.{ie-fracao}.type,",
				"          Potencia_Alimentar = tbl_inst_eletrica_vl.{ie-potencia}.content,",
				"          Nip_inc = tbl_inst_eletrica_vl.{ie-nip}.type,",
				"          Cpe_inc = tbl_inst_eletrica_vl.{ie-cpe}.type,",
				"          Total_Instalado = tbl_inst_eletrica_vl.{ie-total_instal}.content,",
				"          Entrada = tbl_inst_eletrica_vl.{ie-entrada}.content,",
				"          Ramal = tbl_inst_eletrica_vl.{ie-ramal}.content,",
				"          {Tipo_de_Utilização_individual} = tbl_inst_eletrica_vl.{ie-tipo_util}.content,",
				"          Fator_de_Simultaneadade = tbl_inst_eletrica_vl.{ie-fator_simult}.content",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flatten2",
				"flatten2 derive({Tipo_de_Instalação} = toString(byName('Tipo_de_Instalação')),",
				"          Entrada_do_imovel = toString(byName('Entrada_do_imovel')),",
				"          Andar = toString(byName('Andar')),",
				"          Potencia_Alimentar = toString(byName('Potencia_Alimentar')),",
				"          Nip_inc = toString(byName('Nip_inc')),",
				"          Cpe_inc = toString(byName('Cpe_inc')),",
				"          Total_Instalado = toString(byName('Total_Instalado')),",
				"          Entrada = toString(byName('Entrada')),",
				"          Ramal = toString(byName('Ramal')),",
				"          {Tipo_de_Utilização_individual} = toString(byName('Tipo_de_Utilização_individual')),",
				"          Fator_de_Simultaneadade = toString(byName('Fator_de_Simultaneadade'))) ~> MapDrifted1",
				"MapDrifted1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ID as integer,",
				"          ID_CHAVE_DE_NEGOCIO as string,",
				"          DS_RQ_NOME as string,",
				"          VL_RQ_NOME_CONF as decimal(10,2),",
				"          VL_RQ_NIF as string,",
				"          VL_RQ_NIF_CONF as decimal(10,2),",
				"          VL_RQ_TELEFONE as string,",
				"          VL_RQ_TELEFONE_CONF as decimal(10,2),",
				"          DS_RQ_EMAIL as string,",
				"          VL_RQ_EMAIL_CONF as decimal(10,2),",
				"          VL_RQ_MORADA as string,",
				"          VL_RQ_MORADA_CONF as decimal(10,2),",
				"          VL_RQ_CODIGO_POSTAL as string,",
				"          VL_RQ_CODIGO_POSTAL_CONF as decimal(10,2),",
				"          DS_RQ_ASSINATURA as string,",
				"          VL_RQ_ASSINATURA_conf as decimal(10,2),",
				"          DS_TR_NOME as string,",
				"          VL_TR_NOME_CONF as decimal(10,2),",
				"          VL_TR_NIF as string,",
				"          VL_TR_NIF_CONF as decimal(10,2),",
				"          VL_TR_TELEFONE as string,",
				"          VL_TR_TELEFONE_CONF as decimal(10,2),",
				"          DS_TR_EMAIL as string,",
				"          VL_TR_EMAIL_CONF as decimal(10,2),",
				"          VL_TR_NDGEG as string,",
				"          VL_TR_NDGEG_CONF as decimal(10,2),",
				"          DS_DISTRITO as string,",
				"          DS_DISTRITO_CONF as decimal(10,2),",
				"          DS_CONCELHO as string,",
				"          DS_CONCELHO_CONF as decimal(10,2),",
				"          DS_FREGUESIA as string,",
				"          DS_FREGUESIA_CONF as decimal(10,2),",
				"          DS_ENTRADA_E1 as string,",
				"          DS_ENTRADA_E1_CONF as decimal(10,2),",
				"          DS_ENTRADA_E2 as string,",
				"          DS_ENTRADA_E2_CONF as decimal(10,2),",
				"          VL_COORDENADAS as string,",
				"          VL_COORDENADAS_CONF as decimal(10,2),",
				"          DS_TIPO_DE_INSTALACAO as string,",
				"          DS_ENTRADA_DO_IMOVEL as string,",
				"          VL_RAMAL as string,",
				"          VL_NIP as string,",
				"          DS_CPE as string,",
				"          DS_ANDAR as string,",
				"          {DS_FRACÇAO} as string,",
				"          {DS_TIPO_DE_ULITIZAÇAO_INDIVIDUAL} as string,",
				"          DS_ENTRADA as string,",
				"          VL_TOTAL_INSTALADO as string,",
				"          VL_FATOR_DE_SIMULTANEADADE as string,",
				"          VL_POTENCIA_ALIMENTAR as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     mapColumn(",
				"          DS_RQ_NOME = rq_nome,",
				"          VL_RQ_NOME_CONF = rq_nome_conf,",
				"          VL_RQ_NIF = rq_nif,",
				"          VL_RQ_NIF_CONF = rq_nif_conf",
				"     )) ~> sink1"
			]
		}
	}
}